///////////////////////////////////////////////////////////////////////
//   File: evcipher.hpp
//
// Author: $author$
//   Date: 10/25/2007
//
//    $Id$
///////////////////////////////////////////////////////////////////////

#ifndef _EVCIPHER_HPP
#define _EVCIPHER_HPP

#include "evdecryptor.hpp"
#include "evencryptor.hpp"
#include "evcryptoblock.hpp"
#include "evcryptokey.hpp"

///////////////////////////////////////////////////////////////////////
//  Class: EvCipher
//
// Author: $author$
//   Date: 10/25/2007
///////////////////////////////////////////////////////////////////////
class EV_EXPORT_CLASS EvCipher
: virtual public EvCryptoKey,
  virtual public EvCryptoBlock,
  virtual public EvEncryptor,
  virtual public EvDecryptor
{
public:
    typedef EvCryptoKey CImplements;
    typedef EvCipher CDerives;

    ///////////////////////////////////////////////////////////////////////
    // Function: Initialize
    //
    //   Author: $author$
    //     Date: 11/16/2007
    ///////////////////////////////////////////////////////////////////////
    virtual LONG Initialize
    (const BYTE* key, LONG keyLength=-1,
     const BYTE* iv=0, LONG ivLength=-1,
     BYTE padding=0) = 0;

    ///////////////////////////////////////////////////////////////////////
    //   Enum:  
    //
    // Author: $author$
    //   Date: 12/3/2007
    ///////////////////////////////////////////////////////////////////////
    enum 
    {
        EV_BLOCK_SIZE = 1,
        EV_KEY_SIZE   = 0,
        EV_IV_SIZE    = 0
    };

    ///////////////////////////////////////////////////////////////////////
    // Function: SetIVSize
    //
    //   Author: $author$
    //     Date: 10/25/2007
    ///////////////////////////////////////////////////////////////////////
    virtual LONG SetIVSize
    (ULONG size) = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: GetIVSize
    //
    //   Author: $author$
    //     Date: 10/25/2007
    ///////////////////////////////////////////////////////////////////////
    virtual LONG GetIVSize() const = 0;
};
#endif // _EVCIPHER_HPP
