///////////////////////////////////////////////////////////////////////
//   File: evservlet.hpp
//
// Author: $author$
//   Date: 4/13/2007
//
//    $Id$
///////////////////////////////////////////////////////////////////////

#ifndef _EVSERVLET_HPP
#define _EVSERVLET_HPP

#include "evservletrequest.hpp"
#include "evservletresponse.hpp"
#include "evservletserver.hpp"
#include "evinstance.hpp"
#include "evbase.hpp"

#define EV_SERVLET_ACQUIRE EvServletAcquire
#define EV_SERVLET_ACQUIRE_SYMBOL DLL_SYMBOL(EV_SERVLET_ACQUIRE)

#define EV_SERVLET_RELEASE EvServletRelease
#define EV_SERVLET_RELEASE_SYMBOL DLL_SYMBOL(EV_SERVLET_RELEASE)

class EV_EXPORT_CLASS EvServletContext;

///////////////////////////////////////////////////////////////////////
//  Class: EvServlet
//
// Author: $author$
//   Date: 4/13/2007
///////////////////////////////////////////////////////////////////////
class EV_EXPORT_CLASS EvServlet
: virtual public EvInstance
{
public:
    typedef EvInstance CImplements;
    typedef EvServlet CDerives;

    ///////////////////////////////////////////////////////////////////////
    // Function: Initialize
    //
    //   Author: $author$
    //     Date: 4/21/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvError Initialize(EvServletServer& server) = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: Finalize
    //
    //   Author: $author$
    //     Date: 4/21/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvError Finalize(EvServletServer& server) = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: ConnectionInitialize
    //
    //   Author: $author$
    //     Date: 9/22/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvError ConnectionInitialize
    (EvServletConnection& connection) = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: ConnectionFinalize
    //
    //   Author: $author$
    //     Date: 9/22/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvError ConnectionFinalize
    (EvServletConnection& connection) = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: Service
    //
    //   Author: $author$
    //     Date: 4/13/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvError Service
    (EvServletRequest& request,
     EvServletResponse& response) = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: SetName
    //
    //   Author: $author$
    //     Date: 4/20/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvError SetName
    (const char* chars, LONG length=-1) = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: GetName
    //
    //   Author: $author$
    //     Date: 4/20/2007
    ///////////////////////////////////////////////////////////////////////
    virtual const char* GetName
    (LONG& length) const = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: CompareName
    //
    //   Author: $author$
    //     Date: 4/30/2007
    ///////////////////////////////////////////////////////////////////////
    virtual int CompareName
    (const char* chars, LONG length=-1) const = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: SetParentServlet
    //
    //   Author: $author$
    //     Date: 5/24/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvError SetParentServlet
    (EvServlet* servlet) = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: GetParentServlet
    //
    //   Author: $author$
    //     Date: 5/24/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvServlet* GetParentServlet() const = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: SetRootServlet
    //
    //   Author: $author$
    //     Date: 12/21/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvError SetRootServlet
    (EvServlet* servlet) = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: GetRootServlet
    //
    //   Author: $author$
    //     Date: 12/21/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvServlet* GetRootServlet() const = 0;
    ///////////////////////////////////////////////////////////////////////
    // Function: FindServlet
    //
    //   Author: $author$
    //     Date: 5/24/2007
    ///////////////////////////////////////////////////////////////////////
    virtual EvServlet* FindServlet
    (const char* name, LONG length=-1) const = 0;
};

extern "C" 
{
///////////////////////////////////////////////////////////////////////
//  Typedef: FEvServletAcquire
//
//   Author: $author$
//     Date: 9/10/2007
///////////////////////////////////////////////////////////////////////
typedef EV_PLATFORM_EXPORT EvServlet*
FEvServletAcquire(EvError& error);

///////////////////////////////////////////////////////////////////////
//  Typedef: FEvServletRelease
//
//   Author: $author$
//     Date: 9/10/2007
///////////////////////////////////////////////////////////////////////
typedef EV_PLATFORM_EXPORT EvError
FEvServletRelease(EvServlet* servlet);

///////////////////////////////////////////////////////////////////////
// Function: EV_SERVLET_ACQUIRE
//
//   Author: $author$
//     Date: 9/10/2007
///////////////////////////////////////////////////////////////////////
EV_PLATFORM_EXPORT EvServlet* 
EV_SERVLET_ACQUIRE(EvError& error);

///////////////////////////////////////////////////////////////////////
// Function: EV_SERVLET_RELEASE
//
//   Author: $author$
//     Date: 9/10/2007
///////////////////////////////////////////////////////////////////////
EV_PLATFORM_EXPORT EvError 
EV_SERVLET_RELEASE(EvServlet* servlet=0);
} // extern "C"
#endif // _EVSERVLET_HPP
