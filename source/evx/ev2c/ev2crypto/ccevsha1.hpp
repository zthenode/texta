///////////////////////////////////////////////////////////////////////
//   File: ccevsha1.hpp
//
// Author: $author$
//   Date: 11/4/2007
//
//    $Id$
///////////////////////////////////////////////////////////////////////

#ifndef _CCEVSHA1_HPP
#define _CCEVSHA1_HPP

#include <vector>
#include "ccevhash.hpp"
#include "cevsha1.hpp"
#include "csha1.hxx"

///////////////////////////////////////////////////////////////////////
//  Class: CCEvSHA1
//
// Author: $author$
//   Date: 11/4/2007
///////////////////////////////////////////////////////////////////////
class CCEvSHA1
: virtual public EvSHA1,
  public CCEvHash
{
public:
    typedef EvSHA1 CImplements;
    typedef CCEvHash CExtends;
    typedef CCEvSHA1 CDerives;

    CSHA1 m_sha1;

    ///////////////////////////////////////////////////////////////////////
    // Constructor: CCEvSHA1
    //
    //       Author: $author$
    //         Date: 11/4/2007
    ///////////////////////////////////////////////////////////////////////
    CCEvSHA1() 
    {
        m_hash = &m_sha1;
    }
    ///////////////////////////////////////////////////////////////////////
    // Destructor: ~CCEvSHA1
    //
    //      Author: $author$
    //        Date: 11/4/2007
    ///////////////////////////////////////////////////////////////////////
    virtual ~CCEvSHA1()
    {
        m_hash = 0;
    }

    ///////////////////////////////////////////////////////////////////////
    // Function: GetHashSize
    //
    //   Author: $author$
    //     Date: 12/5/2007
    ///////////////////////////////////////////////////////////////////////
    virtual LONG GetHashSize() const 
    {
        LONG hashSize = EV_HASH_SIZE;
        return hashSize;
    }
    ///////////////////////////////////////////////////////////////////////
    // Function: DeleteThis
    //
    //   Author: $author$
    //     Date: 2/12/2009
    ///////////////////////////////////////////////////////////////////////
    virtual EvError DeleteThis() 
    {
        EvError error = EV_ERROR_NONE;
        delete this;
        return error;
    }
};

///////////////////////////////////////////////////////////////////////
//  Typedef: CCEvSHA1s
//
//   Author: $author$
//     Date: 11/4/2007
///////////////////////////////////////////////////////////////////////
typedef ::std::vector<CCEvSHA1*>
CCEvSHA1s;

///////////////////////////////////////////////////////////////////////
//  Typedef: CCEvSHA1sIterator
//
//   Author: $author$
//     Date: 11/4/2007
///////////////////////////////////////////////////////////////////////
typedef CCEvSHA1s::iterator
CCEvSHA1sIterator;

///////////////////////////////////////////////////////////////////////
//  Typedef: const_CCEvSHA1sIterator
//
//   Author: $author$
//     Date: 11/4/2007
///////////////////////////////////////////////////////////////////////
typedef CCEvSHA1s::const_iterator
const_CCEvSHA1sIterator;

#endif // _CCEVSHA1_HPP
