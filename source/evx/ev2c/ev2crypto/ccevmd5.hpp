///////////////////////////////////////////////////////////////////////
//   File: ccevmd5.hpp
//
// Author: $author$
//   Date: 11/4/2007
//
//    $Id$
///////////////////////////////////////////////////////////////////////

#ifndef _CCEVMD5_HPP
#define _CCEVMD5_HPP

#include <vector>
#include "ccevhash.hpp"
#include "cevmd5.hpp"
#include "cmd5.hxx"

///////////////////////////////////////////////////////////////////////
//  Class: CCEvMD5
//
// Author: $author$
//   Date: 11/4/2007
///////////////////////////////////////////////////////////////////////
class CCEvMD5
: virtual public EvMD5,
  public CCEvHash
{
public:
    typedef EvMD5 CImplements;
    typedef CCEvHash CExtends;
    typedef CCEvMD5 CDerives;

    CMD5 m_md5;

    ///////////////////////////////////////////////////////////////////////
    // Constructor: CCEvMD5
    //
    //       Author: $author$
    //         Date: 11/4/2007
    ///////////////////////////////////////////////////////////////////////
    CCEvMD5() 
    {
        m_hash = &m_md5;
    }
    ///////////////////////////////////////////////////////////////////////
    // Destructor: ~CCEvMD5
    //
    //      Author: $author$
    //        Date: 11/4/2007
    ///////////////////////////////////////////////////////////////////////
    virtual ~CCEvMD5()
    {
        m_hash = 0;
    }

    ///////////////////////////////////////////////////////////////////////
    // Function: GetHashSize
    //
    //   Author: $author$
    //     Date: 12/5/2007
    ///////////////////////////////////////////////////////////////////////
    virtual LONG GetHashSize() const 
    {
        LONG hashSize = EV_HASH_SIZE;
        return hashSize;
    }
    ///////////////////////////////////////////////////////////////////////
    // Function: DeleteThis
    //
    //   Author: $author$
    //     Date: 2/12/2009
    ///////////////////////////////////////////////////////////////////////
    virtual EvError DeleteThis() 
    {
        EvError error = EV_ERROR_NONE;
        delete this;
        return error;
    }
};

///////////////////////////////////////////////////////////////////////
//  Typedef: CCEvMD5s
//
//   Author: $author$
//     Date: 11/4/2007
///////////////////////////////////////////////////////////////////////
typedef ::std::vector<CCEvMD5*>
CCEvMD5s;

///////////////////////////////////////////////////////////////////////
//  Typedef: CCEvMD5sIterator
//
//   Author: $author$
//     Date: 11/4/2007
///////////////////////////////////////////////////////////////////////
typedef CCEvMD5s::iterator
CCEvMD5sIterator;

///////////////////////////////////////////////////////////////////////
//  Typedef: const_CCEvMD5sIterator
//
//   Author: $author$
//     Date: 11/4/2007
///////////////////////////////////////////////////////////////////////
typedef CCEvMD5s::const_iterator
const_CCEvMD5sIterator;

#endif // _CCEVMD5_HPP
